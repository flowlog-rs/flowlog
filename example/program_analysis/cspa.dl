.decl Assign(x: int32, y: int32)
.input Assign(IO="file", filename="Assign.csv", delimiter=",")

.decl Dereference(x: int32, y: int32)
.input Dereference(IO="file", filename="Dereference.csv", delimiter=",")

.decl ValueFlow(x: int32, y: int32)
.decl MemoryAlias(x: int32, y: int32)
.decl ValueAlias(x: int32, y: int32)

ValueFlow(y, x) :- Assign(y, x).
ValueFlow(x, y) :- Assign(x, z), MemoryAlias(z, y).
ValueFlow(x, y) :- ValueFlow(x, z), ValueFlow(z, y).
MemoryAlias(x, w) :- Dereference(y, x), ValueAlias(y, z), Dereference(z, w).
ValueAlias(x, y) :- ValueFlow(z, x), ValueFlow(z, y).
ValueAlias(x, y) :- ValueFlow(z, x), MemoryAlias(z, w), ValueFlow(w, y).
ValueFlow(x, x) :- Assign(x, y).
ValueFlow(x, x) :- Assign(y, x).
MemoryAlias(x, x) :- Assign(y, x).
MemoryAlias(x, x) :- Assign(x, y).

.printsize ValueFlow
.printsize MemoryAlias
.printsize ValueAlias